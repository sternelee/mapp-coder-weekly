(wx.webpackJsonp=wx.webpackJsonp||[]).push([[21],{"24":function(t,e,n){"use strict";n.r(e);var r=n(5),o=n.n(r);for(var i in r)"default"!==i&&function(t){n.d(e,t,function(){return r[t]})}(i);e.default=o.a},"43":function(t,e,n){t.exports=n.p+"pages/post/index.wxml"},"5":function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{"value":!0});var l=_interopRequireDefault(n(22)),g=function(t,e){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return function sliceIterator(t,e){var n=[],r=!0,o=!1,i=void 0;try{for(var a,u=t[Symbol.iterator]();!(r=(a=u.next()).done)&&(n.push(a.value),!e||n.length!==e);r=!0);}catch(t){o=!0,i=t}finally{try{!r&&u.return&&u.return()}finally{if(o)throw i}}return n}(t,e);throw new TypeError("Invalid attempt to destructure non-iterable instance")},r=function(t,e,n){return e&&defineProperties(t.prototype,e),n&&defineProperties(t,n),t};function defineProperties(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var o,i,a=n(42),m=n(0),p=_interopRequireDefault(m),u=n(21),f=n(74);function _interopRequireDefault(t){return t&&t.__esModule?t:{"default":t}}function _asyncToGenerator(t){return function(){var a=t.apply(this,arguments);return new Promise(function(o,i){return function step(t,e){try{var n=a[t](e),r=n.value}catch(t){return void i(t)}if(!n.done)return Promise.resolve(r).then(function(t){step("next",t)},function(t){step("throw",t)});o(r)}("next")})}}function _possibleConstructorReturn(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}n(75);var s,c=(function _inherits(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{"constructor":{"value":t,"enumerable":!1,"writable":!0,"configurable":!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(Index,m.Component),r(Index,[{"key":"_constructor","value":function _constructor(){(function get(t,e,n){null===t&&(t=Function.prototype);var r=Object.getOwnPropertyDescriptor(t,e);if(void 0===r){var o=Object.getPrototypeOf(t);return null===o?void 0:get(o,e,n)}if("value"in r)return r.value;var i=r.get;return void 0!==i?i.call(n):void 0})(Index.prototype.__proto__||Object.getPrototypeOf(Index.prototype),"_constructor",this).apply(this,arguments),this.state={"md":"","title":"","top":0,"url":"","img":""},this.$$refs=new p.default.RefsArray}},{"key":"onShareAppMessage","value":function onShareAppMessage(t){var e=this.$router.params,n=this.state.title;return"button"===t.from&&console.log(t.target),{"title":""+n,"path":"pages/post/index?cid="+e.cid+"&id="+e.id,"success":function success(t){console.log("转发成功:"+JSON.stringify(t))},"fail":function fail(t){console.log("转发失败:"+JSON.stringify(t))}}}},{"key":"componentWillMount","value":function componentWillMount(){var t=p.default.getMenuButtonBoundingClientRect();this.setState({"top":t.top+2})}},{"key":"componentDidShow","value":(s=_asyncToGenerator(l.default.mark(function _callee(){var e,n,r,o,i,a,u,s,c=this;return l.default.wrap(function _callee$(t){for(;;)switch(t.prev=t.next){case 0:if((e=this.props.weeklyStore).cTitle){t.next=4;break}return t.next=4,e.getCategorys();case 4:return n=this.$router.params,r=Number(n.cid||0),o=e.categorys.map(function(t){return Number(t.cid)}),i=o.indexOf(r),e.tab=i,e.cid=r,e.cTitle=e.categorys[i].title,p.default.showLoading({"title":"Loading ..."}),t.next=14,this.props.weeklyStore.getPost(n.id);case 14:if(a=t.sent,u=a.url,p.default.hideLoading(),a.content){t.next=20;break}return p.default.showToast({"title":"无法拉取数据","duration":1e3}).then(function(){p.default.setClipboardData({"data":c.props.weeklyStore.targetPost,"success":function success(){p.default.showToast({"title":"原文链接已复制","duration":1e3}).then(function(){return c.onHome()})}})}),t.abrupt("return");case 20:s=(0,f.fixUrl)(a.content,u),this.setState({"title":a.title,"url":a.url,"img":a.lead_image_url,"md":s});case 22:case"end":return t.stop()}},_callee,this)})),function componentDidShow(){return s.apply(this,arguments)})},{"key":"_createData","value":function _createData(t,e,n){this.__state=t||this.state||{},this.__props=e||this.props||{};var r=this.$prefix,o=(0,m.genCompid)(r+"$compid__71"),i=g(o,2),a=i[0],u=i[1],s=this.__state,c=(s.md,s.title,s.top),l=(s.img,this.__props.weeklyStore),p=l.categorys,f=l.cTitle,d=l.tab,_=(p.length?p[d]:{"title":"","color":""}).color,h=(0,m.internal_inline_style)({"background":_,"padding":c+"px 0 0 10px","height":"35px"}),y=(0,m.internal_inline_style)({"padding":"10px","background":_});return m.propsManager.set({"name":"home","size":50,"color":"#fff"},u,a),Object.assign(this.__state,{"anonymousState__temp":h,"anonymousState__temp2":y,"$compid__71":u,"cTitle":f}),this.__state}}]),i=o=Index,o.$$events=["onHome","onCopyUrl"],o.$$componentPath="pages/post/index",i);function Index(){var t,e,n;!function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,Index);for(var r=arguments.length,o=Array(r),i=0;i<r;i++)o[i]=arguments[i];return(e=n=_possibleConstructorReturn(this,(t=Index.__proto__||Object.getPrototypeOf(Index)).call.apply(t,[this].concat(o)))).$usedState=["anonymousState__temp","anonymousState__temp2","$compid__71","img","md","cTitle","title","top","url","weeklyStore"],n.config={"navigationBarTitleText":"详情页","navigationStyle":"custom","usingComponents":{"wemark":"../../wemark/wemark"}},n.onHome=function(){1<p.default.getCurrentPages().length?p.default.navigateBack():p.default.navigateTo({"url":"/pages/index/index?cid="+n.props.weeklyStore.cid})},n.onCopyUrl=function(){var t=n.state.url;p.default.setClipboardData({"data":t,"success":function success(){p.default.showToast({"title":"原文链接已复制","duration":1e3})}})},n.customComponents=["IconFont"],_possibleConstructorReturn(n,e)}c=(0,a.__decorate)([(0,u.inject)("weeklyStore"),u.observer],c),e.default=c,Component(n(0).default.createComponent(c,!0))},"72":function(t,e,n){"use strict";n.r(e);n(73);var r=n(24);for(var o in r)"default"!==o&&function(t){n.d(e,t,function(){return r[t]})}(o)},"73":function(t,e,n){"use strict";n(43)},"74":function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{"value":!0});e.fixUrl=function fixUrl(t,n){var e=t.replace(/(\.\.\/)+/g,function(t){var e=t.length/3;return n.split("/").map(function(t){return t+"/"}).slice(0,0-e-1).join("")}),r=n.split("://")[0]+"://"+n.split("://")[1].split("/")[0];return e=e.replace(/!\[\]\(([^\)]+)\)/g,function(t,e){return-1<e.indexOf("://")?t:"![]("+r+e+")"})};e.default={}},"75":function(t,e,n){}},[[72,0,1]]]);